---
title: JSON / API Output
redirect_from:
  - /reporting/machine-output.html
---

# JSON / API output

This page defines machine-readable outputs for SIEM/SOAR/email gateway integration.

## CLI JSON output (current)

Command:

```bash
phish-agent detect --input examples/email_sample.json --format json
```

Generated by `apps/cli/main.py` with fields:

- `verdict`: `benign` / `suspicious` / `phishing`
- `risk_score`: 0â€“100
- `trace_id`: run identifier
- `profile`: FAST/STANDARD/DEEP
- `explanation`: serialized `Explanation`

## Explanation structure

`schemas/explanation_schema.py`:

- `verdict`
- `risk_score`
- `top_signals`: `hard_rule:<code>` or `score_factor:<factor>`
- `recommended_action`: `allow` / `warn` / `quarantine`
- `evidence`: structured evidence references (no raw email content)
- `score_breakdown`: value/weight/contribution per factor

## Stability and versioning

To avoid breaking integrations:

- keep `verdict/risk_score/recommended_action` semantics stable
- only add fields, do not remove or change meaning
- consider adding `schema_version` for breaking changes (not yet in core)

## Suggested SIEM/SOAR fields (optional)

Integration layers can add upstream metadata:

- `message_id`, `tenant_id`, `user_id`
- `sender_domain`, `reply_to_domain`
- `urls` (raw + normalized)
- `attachments` (sha256, mime, size)
- `received_ts`
- `pipeline_config_hash` (config/rule version)

Combine these with detection outputs for traceability and correlation.
